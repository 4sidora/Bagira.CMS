<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>elFinder</title>
	<!--
	<script type='text/javascript' src='http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js'></script>
	-->
	<link rel="stylesheet" href="js/ui-themes/base/ui.all.css" type="text/css" media="screen" title="no title" charset="utf-8">
	<link rel="stylesheet" href="css/elfinder.css" type="text/css" media="screen" title="no title" charset="utf-8">

	<!--
	<script src="js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/jquery-ui-1.8b1.min.js" type="text/javascript" charset="utf-8"></script>
	-->

	<script src="js/jquery-1.4.1.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/jquery-ui-1.7.2.custom.min.js" type="text/javascript" charset="utf-8"></script>

	<script src="js/elfinder.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/i18n/elfinder.ru.js" type="text/javascript" charset="utf-8"></script>


	<script type="text/javascript" charset="utf-8">

        $().ready(function() {
            
            var funcNum = window.location.search.replace(/^.*CKEditorFuncNum=(\d+).*$/, "$1");
            var langCode = window.location.search.replace(/^.*langCode=([a-z]{2}).*$/, "$1");
            var fname = window.location.search.replace(/^.*fname=([a-z_1-9]+).*$/, "$1");

            $('#finder').elfinder({
                url : '/css_mpanel/elfinder/connectors/php/connector.php',
                lang : langCode,
                places: '',
                editorCallback : function(url) {

                  if (fname != '' && fname[0] != '?') {

                      window.opener.setFileField(url, fname);
                      window.close();
                      
                  } else {
                      window.opener.CKEDITOR.tools.callFunction(funcNum, url);
                      window.close();
                  }
               }
            });

            $(window).resize(function() {
	            var root = document.getElementById('finder');
                var height = $(window).height() - 64;
	            $(root.childNodes[1].childNodes[0]).css('height', height);
	            $(root.childNodes[1].childNodes[1]).css('height', height);
	        });

            $(window).resize();

		});
	</script>

</head>
<body>
	<div id="finder">finder</div>

</body>
</html>
